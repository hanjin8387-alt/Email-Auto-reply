# MailTriageAssistant 사용 설명서 (비전공자용)

이 문서는 회사 PC에서 MailTriageAssistant를 설치하고 사용하는 방법을, 가능한 한 쉽게 풀어서 설명합니다.

---

## 0. 한 줄 요약

**Outlook 메일을 우선순위로 정리하고, 개인정보를 자동으로 가린(마스킹) 요약을 만들어 Teams Copilot에 붙여 넣기 쉽게 도와주는 프로그램**입니다.

---

## 1. 이 프로그램이 하는 일 / 안 하는 일

### 1-1. 하는 일
- Outlook 받은편지함에서 메일 목록을 가져옵니다.
- 메일을 분류합니다(예: Action, Approval, VIP, Meeting, Newsletter, FYI 등).
- 메일 내용을 표시하거나 복사할 때 **개인정보(PII)를 자동으로 가립니다.**
- Teams Copilot에 붙여 넣기 좋은 **Digest(요약 표)**를 만들어 클립보드에 복사하고 Teams를 엽니다.
- 복사한 내용은 **30초 후 자동으로 클립보드에서 지웁니다.**

### 1-2. 안 하는 일(중요)
- 메일 본문을 파일로 저장하지 않습니다.
- 외부 AI API(OpenAI/Azure AI 등)에 메일 내용을 전송하지 않습니다.
- New Outlook(새 Outlook, `olk.exe`)은 지원하지 않습니다(차단).

주의:
- 이 앱이 외부 AI API를 호출하지는 않지만, 사용자가 Digest를 Teams Copilot에 붙여넣으면 그 내용은 Teams/Copilot으로 전달됩니다.
  회사 보안/개인정보 정책에 따라 사용하세요.

---

## 2. 실행에 필요한 조건(필수 준비물)

1. Windows 10/11
2. **Classic Outlook(데스크톱 Outlook) 설치 및 로그인**
   - Outlook이 실행 중이어야 합니다(창을 열어두는 것을 권장).
3. (선택) Microsoft Teams
   - 없어도 브라우저(웹 Teams)로 열릴 수 있습니다.

---

## 3. 회사 PC로 옮겨서 사용하는 방법(설치)

이 프로그램은 설치 프로그램이 아니라 “압축 풀고 실행” 방식입니다.

### 3-1. 전달해야 하는 파일
- 배포 ZIP 파일 1개
  - 예: `MailTriageAssistant-win-x64-YYYYMMDD_HHMMSS.zip`
  - 가능하면 `win-x64`를 먼저 사용하세요(대부분 회사 PC는 64비트).
  - 잘 모르겠으면 `win-x64`와 `win-x86` 둘 다 전달한 후, 회사 PC에서 `win-x64`부터 실행해 보세요.

### 3-2. 회사 PC에서 설치(압축 해제)
1. ZIP 파일을 원하는 폴더로 복사합니다.
2. ZIP을 우클릭해서 “압축 풀기”를 실행합니다.
3. 권장 폴더 예시:
   - `C:\\Tools\\MailTriageAssistant\\`
   - `D:\\Tools\\MailTriageAssistant\\`

### 3-3. 실행
- 압축을 푼 폴더에서 `MailTriageAssistant.exe`를 더블 클릭합니다.

Windows SmartScreen이 뜨는 경우:
- “추가 정보” → “실행”으로 진행해야 할 수 있습니다(회사 정책에 따라 다름).

---

## 4. 첫 실행 전에 꼭 확인할 것(문제 예방)

1. **Outlook이 “Classic Outlook(데스크톱)”인지 확인**
2. Outlook이 실행 중인지 확인
3. New Outlook(새 Outlook)이 켜져 있으면 끄기
   - 이 앱은 New Outlook(`olk.exe`)을 감지하면 “지원하지 않음” 오류를 보여주고 동작을 멈춥니다.

---

## 5. 화면 구성(버튼/입력칸이 무엇인지)

### 5-1. 상단(가장 자주 사용)
- **메일 불러오기**: Outlook 받은편지함에서 메일을 가져와서 점수/분류를 계산합니다.
- **Digest 생성 + Teams**: 상위 메일을 Digest(표)로 만들어 클립보드에 복사하고 Teams를 엽니다.
- **Teams 사용자 이메일 입력칸(선택)**:
  - 특정 사람에게 Teams 채팅창을 바로 열고 싶을 때 이메일을 입력합니다.
  - 비워두면 Teams 메인 화면을 여는 방식으로 동작합니다.
- 로딩 바: 작업 중일 때 표시됩니다.

### 5-2. 왼쪽(메일 리스트)
- 각 메일에 대해:
  - 점수(0~100)
  - 분류(Category)
  - 발신자/제목(개인정보 자동 마스킹된 표시)
  - 수신 시간
  - 첨부 여부
- 위쪽 필터에서 “VIP만 보기” 같은 필터가 가능합니다.

### 5-3. 오른쪽(선택한 메일 상세)
- 제목/보낸 사람/받은 시간/간단 힌트가 표시됩니다.
- 아래에 “마스킹된 요약”이 표시됩니다.
- 버튼:
  - **Outlook에서 열기**: 원본 메일을 Outlook에서 엽니다.
  - **Copilot용 복사**: 마스킹된 요약을 클립보드에 복사합니다(30초 후 자동 삭제).
  - **템플릿 답장**: 답장 템플릿으로 Outlook “초안”을 만듭니다(전송은 사용자가 확인 후).
  - **Digest 복사+Teams**: Digest를 복사하고 Teams를 여는 기능(상단 버튼과 동일).

### 5-4. 하단(상태 메시지)
- 현재 작업 상태(불러오는 중/완료/오류)를 짧게 보여줍니다.

---

## 6. 기본 사용 흐름(추천)

### 6-1. 메일 불러오기
1. Classic Outlook을 실행합니다.
2. MailTriageAssistant를 실행합니다.
3. **메일 불러오기** 버튼을 클릭합니다.
4. 잠시 기다리면 왼쪽 리스트에 메일이 나타납니다.

### 6-2. 중요한 메일부터 보기
1. 왼쪽 리스트에서 점수가 높은 메일부터 클릭합니다.
2. 오른쪽에 요약이 뜹니다.
   - 처음 클릭 시 Outlook에서 본문을 읽어오는 시간이 필요할 수 있습니다.
   - 로딩 중에는 “본문을 불러오는 중…”이 표시됩니다.

### 6-3. Copilot에 붙여 넣기(요약 복사)
1. 오른쪽에서 **Copilot용 복사** 클릭
2. Teams 또는 문서에 붙여넣기(Ctrl+V)
3. **30초 후 클립보드 자동 삭제**(중요)
   - 실수로 다른 곳에 붙여넣는 사고를 줄이는 목적입니다.

### 6-4. Digest로 한 번에 정리해서 Copilot에게 요청하기
1. **Digest 생성 + Teams** 클릭
2. Digest가 클립보드에 복사되고 Teams가 열립니다.
3. Teams Copilot에 붙여넣기(Ctrl+V)

---

## 7. 트레이(작업표시줄 아이콘)와 종료 방법(매우 중요)

이 앱은 “실수로 창을 닫아도 백그라운드에서 살아있게” 하는 동작이 있습니다.

### 7-1. 창의 X를 눌렀는데 프로그램이 안 꺼진 것처럼 보이는 경우
- 정상입니다.
- 창을 닫으면 프로그램이 종료되는 대신 **트레이로 숨을 수 있습니다.**

### 7-2. 완전히 종료하는 방법
1. 작업 표시줄 오른쪽 아래(트레이)에서 MailTriageAssistant 아이콘을 찾습니다.
2. 아이콘 우클릭 → **Exit(종료)**를 선택합니다.

참고:
- 설정에서 `EnableSystemTray`가 `false`이면 트레이 아이콘이 없고, 창의 X를 누르면 프로그램이 종료됩니다.

---

## 8. 기능별 자세한 설명

### 8-1. 카테고리 필터
- “전체 / Action / Approval / VIP / Meeting / Newsletter / FYI / Other” 중 선택해 해당 카테고리만 볼 수 있습니다.

### 8-2. Outlook에서 열기
- “요약만으로 판단하기 어렵다”면 이 버튼으로 원본 메일을 Outlook에서 확인하세요.

### 8-3. 템플릿 답장(초안 생성)
1. 오른쪽 아래에서 답장 템플릿을 선택합니다.
2. **템플릿 답장** 클릭
3. Outlook에 “초안”이 만들어집니다.
4. 사용자가 내용 확인 후 전송합니다.

### 8-4. 메일 불러오기 범위(몇 개/며칠?)
- 기본적으로 **받은편지함(Inbox)**에서 메일을 불러옵니다.
- 최근 **약 7일** 범위의 메일을 우선 대상으로 합니다(Outlook 환경/권한에 따라 제한 방식이 달라질 수 있습니다).
- 한 번에 최대 **50개**까지 목록에 표시됩니다.
- 정렬은 “점수 높은 순 → (동점이면) 최신 수신 시간 순”입니다.

### 8-5. 본문/요약은 어떻게 만들어지나요?
- 메일을 클릭하면 Outlook에서 본문을 읽어와서 요약을 업데이트합니다.
- 성능/안전 목적(속도 + 과도한 노출 방지)으로, 본문은 **최대 1500자 정도까지만** 읽어서 처리합니다.
  - 전체 원문이 필요하면 **Outlook에서 열기**로 확인하세요.
- 요약/표시/복사되는 내용은 개인정보가 자동으로 가려집니다.
  - 예: 이메일, 전화번호, IP, 주민번호 패턴, 카드번호 패턴, 계좌/여권번호 패턴, URL 토큰 등

### 8-6. Digest는 어떤 기준으로 만들어지나요?
- 기본적으로 상위 **10개 메일**을 대상으로 Digest를 만듭니다.
- Digest는 “표 형태”로 만들어져 Copilot이 읽기 쉽도록 구성됩니다.
- Digest는 클립보드에 복사되며, **30초 후 자동으로 삭제**됩니다.

### 8-7. 자동 새로고침(Auto Refresh)
- `AutoRefreshIntervalMinutes`가 0보다 크면, 설정된 분마다 자동으로 “메일 불러오기”를 실행합니다.
- 자동 새로고침이 연속 3회 실패하면 안전을 위해 자동 새로고침이 일시 정지됩니다.
  - 이때는 상단에 상태가 표시됩니다.
  - 사용자가 **메일 불러오기**를 한 번 수동으로 실행하면 자동 새로고침이 다시 정상화됩니다.

### 8-8. 트레이 메뉴(백그라운드 실행)
- 트레이 아이콘을 우클릭하면 아래 기능을 빠르게 실행할 수 있습니다.
  - 메일 불러오기
  - Digest 생성 + Teams 열기
  - 대시보드(메인 창) 열기
  - 종료
- 트레이 아이콘을 더블클릭해도 메인 창을 다시 열 수 있습니다.

---

## 9. 설정 변경(추천: appsettings.json)

설정 파일은 프로그램 폴더의 `appsettings.json` 입니다.

### 9-1. 자주 쓰는 설정 항목
- `Language`: `"ko"` 또는 `"en"`
- `EnableSystemTray`:
  - `true`: 트레이 기능 사용(기본)
  - `false`: 트레이 기능 사용 안 함(창 X로 종료되는 느낌에 더 가까움)
- `AutoRefreshIntervalMinutes`:
  - `0`: 자동 새로고침 끔(기본)
  - `5`: 5분마다 자동 새로고침
  - 자동 새로고침이 연속 3번 실패하면 자동으로 일시 정지됩니다(안전장치).
- `PrefetchCount`:
  - 메일 본문을 “미리” 몇 개까지 불러올지(0~50 권장)
  - 값이 크면 첫 로딩이 무거워질 수 있습니다.
- `VipSenders`:
  - VIP로 분류할 발신자 이메일 목록
- `ActionKeywords / ApprovalKeywords / MeetingKeywords / NewsletterKeywords / FyiKeywords`:
  - 메일 제목/본문에 이 단어가 포함되면 해당 카테고리 가중치가 적용됩니다.

### 9-2. 설정을 바꿨는데 적용이 안 되는 것 같다면
- 프로그램을 “완전 종료” 후 다시 실행해야 합니다.
  - 창 X는 “숨기기”일 수 있으므로 트레이에서 Exit로 종료하세요.

---

## 10. VIP 발신자 목록 관리(2가지 방법)

VIP 목록은 “공통 기본값(appsettings.json)”과 “개인별 설정(user_settings.json)” 두 경로가 있습니다.

### 10-1. 방법 A: appsettings.json에서 VipSenders 수정(가장 쉬움)
- 장점: 프로그램 폴더만 관리하면 됨
- 단점: PC마다 동일하게 맞추려면 appsettings.json을 배포할 때 같이 관리해야 함

### 10-2. 방법 B: 사용자 설정 파일(user_settings.json) 사용(개인별)
- 파일 위치(Windows):
  - `%APPDATA%\\MailTriageAssistant\\user_settings.json`
  - 예: `C:\\Users\\홍길동\\AppData\\Roaming\\MailTriageAssistant\\user_settings.json`
- 이 파일이 존재하고 VipSenders가 1개 이상이면, 앱 시작 시 VIP 목록을 이 값으로 덮어씁니다.

예시(메모장으로 새 파일 생성 가능):
```json
{
  "vipSenders": [
    "ceo@company.com",
    "teamlead@company.com"
  ]
}
```

---

## 11. 보안/개인정보 보호 동작(꼭 읽어주세요)

1. 메일 본문은 앱이 필요할 때 Outlook에서 읽지만, 파일로 저장하지 않습니다.
2. 화면에 표시되는 요약/복사되는 텍스트는 개인정보가 자동으로 가려집니다.
   - 예: 이메일 주소, 전화번호, IP, 주민번호 패턴, 카드번호 패턴 등
3. 클립보드:
   - 복사 시 항상 마스킹 적용(또는 이미 마스킹된 Digest는 그대로 복사)
   - **30초 후 자동 삭제**
   - Win+V 클립보드 기록에 남지 않도록(가능한 범위에서) 제외 처리합니다.
4. 로그:
   - 로그 파일 위치: `%LOCALAPPDATA%\\MailTriageAssistant\\logs\\`
   - 로그에는 메일 본문이 기록되지 않도록 설계되어 있습니다.

---

## 12. 자주 발생하는 문제 해결(FAQ)

### 12-1. “Classic Outlook이 필요합니다 / New Outlook은 지원하지 않습니다”가 뜹니다
- 해결:
  - New Outlook을 종료하세요.
  - Classic Outlook(데스크톱 Outlook)을 실행하세요.

### 12-2. “Outlook이 실행 중이 아닙니다” 비슷한 메시지가 뜹니다
- 해결:
  - Outlook을 먼저 실행한 후 다시 시도하세요.

### 12-3. Teams가 안 열립니다
- Teams 실행은 1순위로 브라우저(https)로 열고, 실패하면 msteams 링크를 시도합니다.
- 둘 다 실패하면 안내창이 뜨고, Digest는 이미 클립보드에 복사되어 있으니 Teams를 직접 열어서 붙여넣으면 됩니다.

### 12-4. “복사했는데 30초 지나서 사라졌어요”
- 정상 동작입니다(안전장치).
- 바로 붙여넣기(Ctrl+V) 하세요.

### 12-5. 메일이 너무 느리게 뜨거나 PC가 버벅거립니다
- 설정에서 `PrefetchCount`를 줄여보세요(예: 10 → 5 또는 0).
- `AutoRefreshIntervalMinutes`를 0으로 두고 수동으로 불러오기를 사용하는 것도 방법입니다.

---

## 13. (관리자/점검용) 성능/진단 파일 위치

일반 사용자는 몰라도 되는 내용입니다. 문제가 있을 때 점검용으로만 사용하세요.

### 13-1. 로그 파일
- `%LOCALAPPDATA%\\MailTriageAssistant\\logs\\MailTriageAssistant-*.log`

### 13-2. 성능 지표(perf_metrics.json, Debug 전용)
- `%LOCALAPPDATA%\\MailTriageAssistant\\perf_metrics.json`
- 생성 조건:
  - Debug 실행에서 앱이 “정상 종료”될 때 생성됩니다.
  - 창 X는 숨기기일 수 있으므로 트레이에서 Exit로 종료해야 합니다.
- 지표 확인 스크립트:
  - `scripts\\read_perf_metrics.ps1`

---

## 14. 업데이트(새 버전으로 바꾸는 방법)

1. 새 ZIP을 받습니다.
2. 기존 폴더와 다른 위치에 새 폴더로 압축을 풉니다(권장).
3. 새 폴더의 `MailTriageAssistant.exe`를 실행합니다.

참고:
- 개인 VIP 설정(user_settings.json)과 로그는 AppData에 저장되므로,
  프로그램 폴더를 바꿔도 그대로 유지됩니다.
